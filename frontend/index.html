<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes" />
  <meta name="description" content="TWINLOGY IDN - Real-time Digital Twin Sensor Platform monitoring 31 cities across Indonesia with HTTPS security" />
  <meta name="theme-color" content="#667eea" />
  <title>TWINLOGY IDN - Digital Twin Sensor Platform</title>
  <link rel="icon" type="image/svg+xml" href="assets/twinlogy-logo.svg">
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Page-specific styles */
    .page { display: none; }
  </style>
</head>
<body>
  <div class="header">
    <img src="assets/twinlogy-logo.svg" alt="TWINLOGY IDN Logo" class="logo" style="height: 100px; width: 100px;">
    <div>
      <h1 style="margin: 0; color: #2d3748;">TWINLOGY IDN</h1>
      <p style="margin: 4px 0 0 0; color: #718096; font-size: 0.9em;">🔐 Digital Twin Sensor Platform • Secured with HTTPS</p>
    </div>
  </div>

  <nav style="margin-bottom:12px;">
    <a href="#dashboard" data-link>Dashboard</a> |
    <a href="#map" data-link>Map</a> |
    <a href="#location" data-link>Location Check</a> |
    <a href="#stats" data-link>Stats</a>
  </nav>

  <div class="legend">
    <div class="col"><strong>Legenda Suhu:</strong>
      <label><input class="temp-filter" type="checkbox" value="freezing"> <span class="badge badge-temp-freezing">❄️ Beku</span></label>
      <label><input class="temp-filter" type="checkbox" value="very-cold"> <span class="badge badge-temp-very-cold">🥶 Sangat dingin</span></label>
      <label><input class="temp-filter" type="checkbox" value="cold"> <span class="badge badge-temp-cold">🧊 Dingin</span></label>
      <label><input class="temp-filter" type="checkbox" value="cool"> <span class="badge badge-temp-cool">🧥 Sejuk</span></label>
      <label><input class="temp-filter" type="checkbox" value="comfortable"> <span class="badge badge-temp-comfortable">🙂 Nyaman</span></label>
      <label><input class="temp-filter" type="checkbox" value="warm"> <span class="badge badge-temp-warm">☀️ Hangat</span></label>
      <label><input class="temp-filter" type="checkbox" value="hot"> <span class="badge badge-temp-hot">🔥 Panas</span></label>
    </div>
    <div class="col"><strong>Legenda Kelembapan:</strong>
      <span class="badge badge-hum-dry">🏜️ Kering</span>
      <span class="badge badge-hum-comfortable">🙂 Nyaman</span>
      <span class="badge badge-hum-humid">💧 Lembap</span>
      <span class="badge badge-hum-very-humid">🌧️ Sangat lembap</span>
    </div>
  </div>

  <main>
    <section id="page-dashboard" class="page">
      <div style="display:flex; gap:12px; align-items:center; margin-bottom:12px;">
        <div>
          <label>From: <input type="datetime-local" id="filter-from"></label>
          <label>To: <input type="datetime-local" id="filter-to"></label>
          <label>MinTemp: <input type="number" id="filter-minTemp" style="width:80px"></label>
          <label>MaxTemp: <input type="number" id="filter-maxTemp" style="width:80px"></label>
          <br>
          <label>Center Lat: <input type="number" step="0.000001" id="filter-centerLat" style="width:110px"></label>
          <label>Center Lon: <input type="number" step="0.000001" id="filter-centerLon" style="width:110px"></label>
          <label>Radius (km): <input type="number" id="filter-radius" style="width:80px"></label>
          <button id="apply-filters">Apply</button>
          <button id="export-csv">Export CSV</button>
        </div>
        <div style="margin-left:auto">
          <button id="prev-page">Prev</button>
          <span id="page-info">Page 1</span>
          <button id="next-page">Next</button>
        </div>
      </div>
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Sensor ID</th>
            <th>City/Area</th>
            <th>Temperature (°C)</th>
            <th>Humidity (%)</th>
            <th>Coordinates</th>
          </tr>
        </thead>
        <tbody id="data-body">
          <tr><td colspan="6">No data yet</td></tr>
        </tbody>
      </table>
    </section>

    <section id="page-map" class="page" style="display:none">
      <div id="map" style="height:600px; border:1px solid #ccc"></div>
    </section>

    <section id="page-location" class="page" style="display:none">
      <h2>🗺️ Advanced Location Search</h2>
      
      <!-- Quick Actions Bar -->
      <div style="background:#f7fafc; padding:12px; border-radius:8px; margin-bottom:16px; display:flex; gap:12px; flex-wrap:wrap; align-items:center;">
        <button id="loc-detect" style="background:#3182ce; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:600;">
          📍 Detect My Location
        </button>
        <button id="loc-show-favorites" style="background:#805ad5; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:600;">
          ⭐ Favorite Locations
        </button>
        <button id="loc-compare-mode" style="background:#38a169; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:600;">
          🔄 Compare Locations
        </button>
        <span id="loc-status" style="margin-left:auto; color:#666; font-size:0.9em;"></span>
      </div>

      <!-- Search Box with Autocomplete -->
      <div style="margin-bottom:16px; position:relative;">
        <label style="font-weight:600; display:block; margin-bottom:6px;">🔍 Search Location:</label>
        <div style="display:flex; gap:8px; align-items:center;">
          <input type="text" id="loc-place" placeholder="Type city, country, or address..." 
                 style="flex:1; padding:10px; border:2px solid #cbd5e0; border-radius:6px; font-size:14px;" 
                 autocomplete="off">
          <button id="loc-geocode" style="background:#3182ce; color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; font-weight:600;">
            Search
          </button>
        </div>
        <div id="loc-suggestions" style="position:absolute; top:100%; left:0; right:0; background:white; border:1px solid #cbd5e0; border-radius:6px; margin-top:4px; display:none; max-height:200px; overflow-y:auto; z-index:100; box-shadow:0 4px 6px rgba(0,0,0,0.1);"></div>
        <span id="loc-geocode-msg" style="display:block; margin-top:4px; color:#666; font-size:0.9em;"></span>
      </div>

      <!-- Manual Coordinates Input -->
      <div style="background:#f7fafc; padding:12px; border-radius:8px; margin-bottom:16px;">
        <details>
          <summary style="cursor:pointer; font-weight:600; margin-bottom:8px;">⚙️ Advanced: Manual Coordinates</summary>
          <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-top:8px;">
            <label>Lat: <input type="number" step="0.000001" id="loc-centerLat" style="width:120px; padding:6px; border:1px solid #cbd5e0; border-radius:4px;"></label>
            <label>Lon: <input type="number" step="0.000001" id="loc-centerLon" style="width:120px; padding:6px; border:1px solid #cbd5e0; border-radius:4px;"></label>
            <label>Radius (km): <input type="number" id="loc-radius" value="5" style="width:80px; padding:6px; border:1px solid #cbd5e0; border-radius:4px;"></label>
            <button id="loc-check" style="background:#4299e1; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer;">Check</button>
            <button id="loc-save-favorite" style="background:#d69e2e; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer;">💾 Save Favorite</button>
          </div>
        </details>
      </div>

      <!-- Active Location Info -->
      <div id="loc-active-info" style="background:#e6fffa; border-left:4px solid #38a169; padding:12px; margin-bottom:16px; display:none;">
        <strong>📍 Active Search Location:</strong>
        <div id="loc-active-details" style="margin-top:6px; font-size:0.95em;"></div>
      </div>

      <!-- Favorites Panel (hidden by default) -->
      <div id="favorites-panel" style="display:none; background:#faf5ff; border:2px solid #805ad5; border-radius:8px; padding:12px; margin-bottom:16px;">
        <h3 style="margin:0 0 12px 0;">⭐ Saved Favorite Locations</h3>
        <div id="favorites-list" style="display:flex; flex-direction:column; gap:8px;"></div>
      </div>

      <!-- Compare Mode Panel (hidden by default) -->
      <div id="compare-panel" style="display:none; background:#f0fff4; border:2px solid #38a169; border-radius:8px; padding:12px; margin-bottom:16px;">
        <h3 style="margin:0 0 12px 0;">🔄 Multi-Location Compare</h3>
        <div id="compare-locations" style="margin-bottom:12px;"></div>
        <button id="compare-execute" style="background:#38a169; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:600;">Compare All</button>
      </div>

      <!-- Results Actions -->
      <div style="display:flex; gap:12px; margin-bottom:12px; align-items:center;">
        <button id="loc-show-map" style="background:#3182ce; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer;">
          🗺️ Show on Map
        </button>
        <label style="display:flex; align-items:center; gap:6px;">
          <input type="checkbox" id="loc-sort-distance">
          <span>Sort by Distance (Nearest First)</span>
        </label>
        <span id="loc-results-count" style="margin-left:auto; font-weight:600; color:#2d3748;"></span>
      </div>

      <!-- Results Table -->
      <div style="overflow-x:auto;">
        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>Distance</th>
              <th>Sensor ID</th>
              <th>City/Area</th>
              <th>Temp</th>
              <th>Hum</th>
              <th>Coordinates</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="loc-results"><tr><td colspan="8" style="text-align:center; padding:20px; color:#a0aec0;">Use search tools above to find sensors 🔍</td></tr></tbody>
        </table>
      </div>
    </section>

    <section id="page-stats" class="page" style="display:none">
      <h2>Statistics</h2>
      <div id="stats-area">
        <div style="display:flex; gap:20px; align-items:center; margin-bottom:12px;">
          <div>
            <strong>Temperature</strong>
            <div id="stats-temp">Avg: - | Min: - | Max: -</div>
          </div>
          <div>
            <strong>Humidity</strong>
            <div id="stats-hum">Avg: - | Min: - | Max: -</div>
          </div>
        </div>
        <div style="display:flex; gap:12px;">
          <div style="flex:1">
            <canvas id="tempChart" height="160"></canvas>
          </div>
          <div style="flex:1">
            <canvas id="humChart" height="160"></canvas>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer style="margin-top: 40px; padding: 20px; border-top: 2px solid #e2e8f0; text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 8px;">
    <div style="display: flex; align-items: center; justify-content: center; gap: 12px; margin-bottom: 8px;">
      <img src="assets/twinlogy-logo.svg" alt="TWINLOGY IDN" style="height: 50px; width: 50px; filter: brightness(0) invert(1);">
      <div style="text-align: left;">
        <strong style="font-size: 1.2em;">TWINLOGY IDN</strong>
        <div style="font-size: 0.85em; opacity: 0.9;">Digital Twin Sensor Platform</div>
      </div>
    </div>
    <div style="font-size: 0.85em; opacity: 0.9;">
      🔐 Secured with HTTPS • 🌍 31 Cities Coverage • 📊 Real-time Monitoring
    </div>
    <div style="margin-top: 8px; font-size: 0.75em; opacity: 0.8;">
      © 2025 TWINLOGY-IDN.COM • All Rights Reserved
    </div>
  </footer>

  <!-- Leaflet CSS/JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <!-- Leaflet Marker Clustering (optional but recommended) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" crossorigin=""/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" crossorigin=""/>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js" crossorigin=""></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script src="script.js"></script>
</body>
</html>